<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AliveFrame AR Experience</title>
  <link rel="icon" type="image/jpeg" href="logo.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#000000">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css" />
 <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
 <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar/dist/mindar-image-aframe.prod.js"></script>
  <style>
    body {
  overflow-y: hidden !important;
        margin: 0;
      overflow: hidden;
      height:100vh;
      font-family: 'Poppins', sans-serif;
      background-color: #000;
    }

    #messageBox,
    #tapNotification {
      z-index: 100;
      background-color: rgb(7,15,96);
      text-align: center;
      color: #fff;
      width: auto;
      padding: .3rem;
      padding-left: .6rem;
      padding-right: .6rem;
      border-radius: .2rem;
      margin-top: .2rem;
      font-size: 1.4rem;
      font-weight: 600;
      /* animation: pulse 1.2s infinite ease-in-out, glow 2s infinite alternate; */
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.08); opacity: 0.8; }
    }

    @keyframes glow {
      from {
        text-shadow: 0 0 5px #00CFFF, 0 0 10px #7B61FF, 0 0 15px #8A2EFF;
      }
      to {
        text-shadow: 0 0 10px #00CFFF, 0 0 20px #7B61FF, 0 0 30px #8A2EFF;
      }
    }

    #messageBox { top: 20px; }
    #tapNotification { display: none; }

    #targetOverlay {
      width: 60vw;
      height: auto;
      opacity: 0.95;
      pointer-events: none;
      z-index: 99;
      box-shadow: 0 0 40px rgba(0, 198, 255, 0.25);
      background-color: rgba(255, 255, 255, 0.02);
    }


    .grid{
      display: flex;
      justify-content: center;
      flex-direction: column;
      align-items: center;
      height: 80vh;
      position: absolute;
      top: 0;
      width: 100%;
    }




    #visitButton {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      background: #7f00ff;
      color: #fff;
      padding: 14px 28px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      height: 2rem;
      z-index: 101;
      width: 80%;
      text-decoration: none;
      display: none;
      opacity:.8;
    }

    .footer {
      position: absolute;
      bottom: 0px;
      width: 100%;
      text-align: center;
      color: #aaa;
      font-size: 12px;
      font-weight: 400;
      z-index: 101;
      background: rgba(0, 0, 0, 0.4);
      padding: 4px 0;
    }

    a-scene {
      height: 100vh;
      width: 100vw;
    }
    
    /* Example usage */

    body, p, .footer, #messageBox,h1, .cta, #visitButton {
  font-family: 'Poppins', sans-serif;

    }
    .a-loader {
  display: none !important;
}

#customLoader {
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background-color: black;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 99999;
}


  </style>
</head>
<body>
  <div id="pwa-install-bar" style="display:none;position:fixed;top:0;left:0;width:100vw;z-index:9999;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.12);padding:0.7rem 1.2rem;display:flex;align-items:center;justify-content:space-between;gap:1rem;">
    <div style="display:flex;align-items:center;gap:0.7rem;">
      <img src="logo.jpg" alt="App Logo" style="width:32px;height:32px;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.08);">
      <span style="font-weight:600;font-size:1.1rem;color:#222;">Install AR Experience</span>
    </div>
    <button id="pwa-install-btn" style="background:#7f00ff;color:#fff;border:none;border-radius:20px;padding:0.5rem 1.3rem;font-size:1rem;font-weight:600;box-shadow:0 1px 4px rgba(0,0,0,0.10);cursor:pointer;">Install</button>
    <button id="pwa-install-close" style="background:none;border:none;font-size:1.5rem;color:#888;cursor:pointer;line-height:1;">&times;</button>
  </div>
  <script>
    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js').then(function(registration) {
          // Registration successful
        }, function(err) {
          // Registration failed
        });
      });
    }

    let deferredPrompt;
    const installBar = document.getElementById('pwa-install-bar');
    const installBtn = document.getElementById('pwa-install-btn');
    const closeBtn = document.getElementById('pwa-install-close');

    function showInstallBar() {
      installBar.style.display = 'flex';
    }
    function hideInstallBar() {
      installBar.style.display = 'none';
    }

    // Hide install bar if app is already installed
    function checkIfInstalled() {
      // For most browsers
      if (window.matchMedia('(display-mode: standalone)').matches) {
        hideInstallBar();
      }
      // For iOS Safari
      if (navigator.standalone) {
        hideInstallBar();
      }
    }
    window.addEventListener('DOMContentLoaded', checkIfInstalled);
    window.addEventListener('appinstalled', () => {
      hideInstallBar();
    });

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      showInstallBar();
    });

    installBtn.addEventListener('click', async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') {
          console.log('User accepted the install prompt');
        } else {
          console.log('User dismissed the install prompt');
        }
        hideInstallBar();
        deferredPrompt = null;
      }
    });

    closeBtn.addEventListener('click', () => {
      hideInstallBar();
    });
  </script>
  
  <div class="grid">
  <img id="targetOverlay" src="pk.jpg" alt="Target Overlay" />
  <div id="tapNotification">Tap Anywhere to Start</div>
  <div style="background-color:rgb(7,15,96);" id="messageBox">Place Camera On Poster</div>
 </div>
 
  <a id="visitButton" href="{{media.redirect_url}}" target="_blank">
    Register now <i class="fa-solid fa-arrow-right-long"></i>
  </a>
  <div class="footer">Powered by Aliveframe</div>
<div id="customLoader">
  <img src="logo.jpg" alt="AliveFrame Logo" style="width:194px; animation: pulse 1.4s infinite ease-in-out;" />
  <p style="margin-top: 0.8rem; font-weight: 500; color: white;">Loading AR Experience...</p>
</div>

  <a-scene
    mindar-image="imageTargetSrc: target.mind; minCameraResolution: {width: 1920, height: 1080}; displayFov: 70; filterMinCF: 0.2; filterBeta: 0.9; maxTrack: 1;uiScanning: false;"
    color-space="sRGB"
    renderer="logarithmicDepthBuffer: true;"
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false"
    embedded
  >
    <a-assets>
      <video
        id="myVideo"
        src="video.mp4"
        preload="auto"
        loop
        playsinline
        crossorigin="anonymous"
      ></video>
    </a-assets>

    <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

    <a-entity id="targetAnchor" mindar-image-target="targetIndex: 0">
      <a-entity id="videoWrapper" position="0 0 0" rotation="0 0 0">
        <a-plane
          id="videoPlane"
			width="1"
			height="1"
			position="0 0 0"
          material="shader: flat; src: #myVideo;"
          visible="false"
        ></a-plane>
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const videoEl = document.getElementById("myVideo");
      const videoPlane = document.getElementById("videoPlane");
      const messageBox = document.getElementById("messageBox");
      const overlayImg = document.getElementById("targetOverlay");
      const tapNotification = document.getElementById("tapNotification");
      const targetAnchor = document.getElementById("targetAnchor");
      const visitBtn = document.getElementById("visitButton");

      let videoPlaying = false;
      let targetFound = false;
      let tapHandledOnce = false;
      let buttonShownOnce = false;

      const startVideo = () => {
        videoEl.play().then(() => {
          videoPlaying = true;
          videoPlane.setAttribute("visible", "true");
          tapNotification.style.display = "none";

          if (!buttonShownOnce) {
            setTimeout(() => {
              visitBtn.style.display = "flex";
              buttonShownOnce = true;
            }, 5000);
          } else {
            visitBtn.style.display = "flex";
          }

        }).catch((err) => {
          console.error("Video error:", err);
          messageBox.textContent = "Tap again to allow video with sound.";
          messageBox.style.display = "block";
        });
      };

      targetAnchor.addEventListener("targetFound", () => {
        targetFound = true;
        messageBox.style.display = "none";
        overlayImg.style.display = "none";

        if (!tapHandledOnce) {
          tapNotification.style.display = "block";
        } else {
          startVideo();
        }
      });

      targetAnchor.addEventListener("targetLost", () => {
        videoPlane.setAttribute("visible", "false");
        if (videoPlaying) {
          videoEl.pause();
          videoPlaying = false;
        }
        overlayImg.style.display = "block";
        messageBox.textContent = "Place Camera On Poster";
        messageBox.style.display = "block";
        tapNotification.style.display = "none";
        visitBtn.style.display = buttonShownOnce ? "flex" : "none";
        targetFound = false;
      });

      document.body.addEventListener("click", () => {
        if (targetFound && !tapHandledOnce) {
          startVideo();
          tapHandledOnce = true;
        }
      });
    });
    
    
    window.addEventListener("load", () => {
  // Wait for MindAR to start
  const sceneEl = document.querySelector('a-scene');
  sceneEl.addEventListener("renderstart", () => {
    const loader = document.getElementById("customLoader");
    if (loader) loader.style.display = "none";
  });
});

  </script>
</body>
</html>